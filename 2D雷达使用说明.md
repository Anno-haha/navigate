# 实时2D雷达系统使用说明

## 🎯 系统特色

### ⚡ 实时性优先设计
- **500ms数据更新**: 比标准系统快1倍
- **60 FPS渲染**: 流畅的动画效果
- **网络延迟监控**: 实时显示系统响应时间
- **性能自适应**: 根据飞机数量自动调整性能

### 🎨 专业雷达界面
- **传统雷达显示**: 绿色扫描线和网格
- **极坐标系统**: 距离环和方位线
- **实时扫描动画**: 模拟真实雷达效果
- **飞机轨迹追踪**: 显示飞行路径

## 🚀 快速启动

### 方法一：使用启动脚本（推荐）
```bash
# 启动2D雷达系统
python start_radar.py

# 快速启动模式
python start_radar.py --quick
```

### 方法二：直接启动
```bash
# 确保nav.py正在运行
python nav.py

# 启动雷达系统
python radar_2d.py
```

### 方法三：与其他系统协同
```bash
# 终端1: 数据采集
python nav.py

# 终端2: 3D可视化
python simple_visual.py

# 终端3: 2D雷达
python radar_2d.py
```

## 🌐 访问地址

- **雷达显示**: http://127.0.0.1:8001/
- **API接口**: http://127.0.0.1:8001/api/radar/aircraft

## 🎮 界面操作

### 🖱️ 鼠标操作
- **点击飞机**: 显示详细信息
- **点击空白**: 关闭详情面板

### ⚙️ 控制面板
- **雷达范围**: 20/50/100/200 km可选
- **雷达扫描**: 开启/关闭扫描动画
- **飞机轨迹**: 显示/隐藏飞行轨迹
- **飞机标签**: 显示/隐藏ICAO代码

### 📊 信息显示
- **雷达状态**: 绿色=在线，红色=离线
- **飞机数量**: 当前雷达范围内飞机数
- **更新频率**: 实时数据更新频率
- **网络延迟**: API响应时间

## 🎨 视觉元素

### 🎯 雷达网格
- **同心圆**: 距离环，标注公里数
- **方位线**: 30度间隔的方位指示
- **中心点**: 红色圆点表示参考位置

### ✈️ 飞机显示
- **颜色编码**:
  - 🔴 红色: 低空飞机 (<10,000ft)
  - 🟡 黄色: 中空飞机 (10,000-33,000ft)
  - 🔵 蓝色: 高空飞机 (>33,000ft)
- **脉冲效果**: 飞机点周围的动态光环
- **轨迹线**: 半透明的飞行路径

### 🌊 扫描效果
- **扫描线**: 绿色渐变扫描线
- **旋转动画**: 3度/帧的平滑旋转
- **可控制**: 可开启/关闭扫描效果

## 📈 性能优化

### ⚡ 实时性优化
```javascript
// 数据更新优化
function startDataUpdate() {
    let lastFetchTime = 0;
    const fetchInterval = 500; // 500ms高频更新
    
    function updateLoop() {
        const now = Date.now();
        if (now - lastFetchTime >= fetchInterval) {
            fetchAircraftData();
            lastFetchTime = now;
        }
        requestAnimationFrame(updateLoop);
    }
    updateLoop();
}
```

### 🎯 渲染优化
- **Canvas硬件加速**: 使用GPU加速渲染
- **增量更新**: 只重绘变化的部分
- **轨迹限制**: 最多30个历史点
- **自动清理**: 过期数据自动删除

### 📊 性能监控
- **FPS显示**: 实时帧率监控
- **延迟测量**: 网络请求延迟
- **内存管理**: 自动清理过期数据

## 🔧 配置选项

### 📁 配置文件 (radar_config.py)
```python
RADAR_CONFIG = {
    'update_interval_ms': 500,      # 更新间隔
    'render_fps': 60,               # 渲染帧率
    'default_range_km': 100,        # 默认范围
    'max_trail_points': 30,         # 最大轨迹点
    'show_sweep_animation': True,   # 扫描动画
}
```

### 🎚️ 性能预设
- **高性能模式**: 250ms更新，60 FPS
- **平衡模式**: 500ms更新，30 FPS
- **低资源模式**: 1000ms更新，15 FPS

### 🎨 颜色主题
- **默认雷达**: 绿色经典雷达风格
- **蓝色雷达**: 蓝色现代风格
- **夜视模式**: 低亮度护眼模式

## 📊 API接口

### 获取雷达数据
```http
GET /api/radar/aircraft?range=100
```

**响应格式**:
```json
{
  "status": "success",
  "aircraft": {
    "7813B1": {
      "icao": "7813B1",
      "distance": 85.2,
      "bearing": 127.5,
      "altitude": 175,
      "speed": 245.8,
      "radar_x": 82104.3,
      "radar_y": 86256.0
    }
  },
  "config": {
    "range_km": 100,
    "center_lat": 39.9,
    "center_lon": 116.4
  }
}
```

### 更新雷达配置
```http
GET /api/radar/config?range=200
```

## 🔍 故障排除

### 常见问题

1. **雷达无数据显示**
   - 检查nav.py是否运行
   - 确认adsb_decoded.log文件更新
   - 检查网络连接状态

2. **动画卡顿**
   - 降低雷达范围
   - 关闭轨迹显示
   - 使用低资源模式

3. **延迟过高**
   - 检查系统资源使用
   - 减少同时运行的程序
   - 调整更新间隔

### 性能调优

1. **高性能设置**:
   ```bash
   # 修改radar_config.py
   'update_interval_ms': 250
   'max_trail_points': 50
   ```

2. **低资源设置**:
   ```bash
   'update_interval_ms': 1000
   'show_sweep_animation': False
   'show_aircraft_trails': False
   ```

## 🎯 使用技巧

### 💡 最佳实践
1. **启动顺序**: 先启动nav.py，再启动雷达系统
2. **范围选择**: 根据飞机密度调整雷达范围
3. **性能监控**: 观察FPS和延迟指标
4. **轨迹管理**: 飞机较多时可关闭轨迹显示

### 🎮 操作技巧
1. **快速查看**: 点击飞机快速查看详情
2. **范围调节**: 根据需要动态调整雷达范围
3. **效果控制**: 根据性能需求开关各种效果
4. **状态监控**: 注意状态指示器颜色变化

## 🔮 扩展功能

### 计划中的功能
- 🎯 **多雷达站**: 支持多个雷达站点
- 📡 **雷达融合**: 多源数据融合显示
- 🎨 **3D雷达**: 立体雷达显示
- 📊 **历史回放**: 飞行轨迹回放功能

### 自定义扩展
- 修改颜色主题
- 调整动画效果
- 添加新的显示元素
- 集成其他数据源

## 🎉 总结

实时2D雷达系统提供：

✅ **超高实时性**: 500ms数据更新，60 FPS渲染  
✅ **专业界面**: 传统雷达风格，直观易用  
✅ **性能优化**: 自适应性能调整  
✅ **丰富功能**: 轨迹追踪、详情查看、范围调节  
✅ **易于使用**: 一键启动，即开即用  

**享受专业级的实时雷达监控体验！** 📡✈️🎯
